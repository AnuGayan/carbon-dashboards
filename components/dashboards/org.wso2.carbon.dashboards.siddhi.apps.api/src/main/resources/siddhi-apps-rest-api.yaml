swagger: '2.0'
info:
  version: 1.0.0
  title: Dashboard Siddhi Apps REST Api
  description: This provides information about siddhi apps deployed in workers.
schemes:
- https
host: localhost
basePath: /portal/apis/datasearch
consumes:
- text/plain
produces:
- application/json
paths:
  /siddhi-apps:
    get:
      summary: Lists Siddhi Apps and workers.
      description:
        Provides siddhi apps which contain @store annotated Aggregation, Table, Window definitions.
      produces:
      - application/json
      responses:
        '200':
          description: The Siddhi Applications are successfully retrieved.
          schema:
            $ref: '#/definitions/SiddhiAppWorker'
        '401':
          description: Insufficient permissions to view siddhi apps.
  '/{id}/{appName}':
    get:
      summary: Retrieves definitions in specified Siddhi Application.
      description: Retrieves @store annotated definitions, definition type and attribute list from a siddhi app.
      produces:
      - application/json
      parameters:
      - name: id
          in: path
          description: Id of the worker.
          required: true
          type: string
      - name: appName
        in: path
        description: The name of the Siddhi Application.
        required: true
        type: string
      responses:
        '200':
          description: Definitions in Siddhi Application are successfully retrieved.
          schema:
            $ref: '#/definitions/SiddhiDefinition'
        '401':
          description: Unauthorized to view siddhi app.
        '404':
          description: The Siddhi Application specified is not found.
          schema:
            $ref: '#/definitions/ApiResponseMessageWithCode'
definitions:
  SiddhiAppContent:
    type: object
    properties:
      content:
        type: string
        description: Content of the Siddhi Application
  SiddhiAppWorker:
    type: object
    properties:
      appName:
        type: string
        description: name of siddhi app
      worker:
        type: string
        description: worker id
  SiddhiDefinition:
    type: object
    properties:
      definitionName:
        type: string
        description: name of definition
      definitionText:
        type: string
        description: text view of definition
      type:
        type: string
        description: type of the definition
      attributes:
        type: List<Attribute>
        description: list of attributes
  Attribute:
    type: object
    properties:
      name:
        type: string
        description: name of the attribute
      type:
        type: string
        description: type of the attribute
  ApiResponseMessageWithCode:
    type: object
    properties:
      code:
        type: integer
        format: int32
        description: Unique error code
      type:
        type: string
        description: Error type
      message:
        type: string
        description: Error message