swagger: '2.0'
info:
  version: 1.0.0
  title: Dashboard Siddhi Apps Api
  description: >-
    This provides information about deployed siddhi apps in given workers.
  license:
    name: Apache 2.0
    url: 'http://www.apache.org/licenses/LICENSE-2.0.html'
schemes:
- https
host: localhost
basePath: /portal/apis
paths:
  /datasearch/siddhi-apps:
    get:
      x-wso2-curl: 'curl -k -X GET https://localhost:9643/portal/apis/datasearch/siddhi-apps'
      x-wso2-request: 'GET https://localhost:9643/portal/apis/datasearch/siddhi-apps'
      x-wso2-response: |-
        HTTP/1.1 200 OK Content-Type: application/json
        ["ShipmentHistoryApp","SweetProductionApp"]
      tags:
      - SiddhiApps
      summary: List Siddhi apps
      description: List Siddhi apps which contain @store annotated definitions
      responses:
        '200':
          description: The Siddhi Applications are successfully retrieved.
          schema:
            type: array
            items:
              type: String
        '401':
          description: Insufficient permission to view siddhi apps.
  'datasearch/{appName}':
    get:
      x-wso2-curl: 'curl -k -X GET https://localhost:9643/portal/apis/datasearch/{appName}'
      x-wso2-request: 'GET https://localhost:9643/portal/apis/datasearch/{appName}'
      x-wso2-response: >-
        HTTP/1.1 200 OK Content-Type: application/json
        [
        {
                "definitionName": "ShipmentDetails",
                "definitionText": "@primaryKey( 'name')@index( 'supplier')@store( type = 'rdbms', jdbc.url = 'jdbc:mysql://localhost:3306/SweetFactoryDB', username = 'root', password = 'root', jdbc.driver.name = 'com.mysql.jdbc.Driver')define table ShipmentDetails (name string, supplier string, amount double)",
                "type": "Table",
                "attributes": [
                    {
                        "name": "name",
                        "type": "STRING"
                    },
                    {
                        "name": "supplier",
                        "type": "STRING"
                    },
                    {
                        "name": "amount",
                        "type": "DOUBLE"
                    }
                ]
            }
        ]
      tags:
      - Definitions
      summary: Retrives @store annotated definitions in a siddhi app
      description: Retrieves @store annotated definitions in a specified siddhi app
      operationId: getSiddhiAppDefinitions
      produces:
      - application/json
      parameters:
      - name: id
        in: path
        description: ID of the worker.
        required: true
        type: string
      responses:
        '200':
          description: Siddhi app definitions successfully retrieved.
          schema:
            type: array
            items:
              type: SiddhiDefinition
              $ref: '#/definitions/SiddhiDefinition'
        '401':
          description: Unauthorized to view siddhi app.
        '404':
          description: The siddhi app specified is not found.
          schema:
            $ref: '#/definitions/ApiResponseMessage'
definitions:
  SiddhiAppContent:
    type: object
    properties:
      content:
        type: string
        description: Content of the Siddhi Application
  SiddhiDefinition:
    type: object
    properties:
      definitionName:
        type: string
        description: name of definition
      definitionText:
        type: string
        description: text view of definition
      type:
        type: string
        description: type of the definition
      attributes:
        type: List<Attribute>
        description: list of attributes
  Attribute:
    type: object
    properties:
      name:
        type: string
        description: name of the attribute
      type:
        type: string
        description: type of the attribute
  ApiResponseMessage:
    type: object
    properties:
      message:
        type: string
        description: Error message
